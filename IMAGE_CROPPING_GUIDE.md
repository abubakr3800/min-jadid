# دليل قص الصور - Image Cropping Guide

## نظرة عامة
تم تطبيق نظام قص الصور في الملفات التالية باستخدام نفس التقنية المستخدمة في `edit-post.php`:

### الملفات المحدثة:
1. **new-post.php** - قص صور الغلاف للمقالات الجديدة
2. **edit-profile.php** - قص الصور الشخصية

### التقنيات المستخدمة:
- **Bootstrap 5.1.3** - للنوافذ المنبثقة (Modals)
- **Cropper.js 1.5.13** - لقص الصور
- **Font Awesome 6.4.0** - للأيقونات

## الميزات المطبقة:

### 1. قص صور الغلاف (new-post.php)
- **نسبة العرض**: 16:9 (مناسبة للمقالات)
- **حجم الإخراج**: 800×450 بكسل
- **الحد الأقصى**: 5 ميجابايت
- **الصيغ المدعومة**: JPG, PNG, GIF, WebP
- **السحب والإفلات**: مدعوم
- **التحقق من الصحة**: تلقائي

### 2. قص الصور الشخصية (edit-profile.php)
- **نسبة العرض**: 1:1 (مربع)
- **حجم الإخراج**: 300×300 بكسل
- **الحد الأقصى**: 5 ميجابايت
- **الصيغ المدعومة**: JPG, PNG, GIF, WebP
- **التحقق من الصحة**: تلقائي

## كيفية الاستخدام:

### قص صورة غلاف:
1. انتقل إلى صفحة "مقال جديد"
2. اضغط على منطقة رفع الصورة
3. اختر صورة من جهازك
4. ستظهر نافذة قص الصورة
5. اضبط منطقة القص كما تريد
6. اضغط "استخدام الصورة"

### قص صورة شخصية:
1. انتقل إلى "تعديل الملف الشخصي"
2. اضغط "تغيير الصورة"
3. اختر صورة من جهازك
4. ستظهر نافذة قص الصورة
5. اضبط منطقة القص (مربع)
6. اضغط "استخدام الصورة"

## استكشاف الأخطاء وإصلاحها:

### المشاكل الشائعة:

#### 1. النافذة المنبثقة لا تفتح
**الحل:**
- تأكد من تحميل Bootstrap JS
- تحقق من وجود أخطاء في وحدة التحكم (F12)
- تأكد من أن Cropper.js محمل بشكل صحيح

#### 2. الصورة لا تظهر في النافذة المنبثقة
**الحل:**
- تحقق من صحة الصورة
- تأكد من أن حجم الصورة أقل من 5 ميجابايت
- تحقق من صيغة الصورة

#### 3. زر "استخدام الصورة" لا يعمل
**الحل:**
- تأكد من تهيئة Cropper بشكل صحيح
- تحقق من وجود أخطاء JavaScript
- تأكد من أن الصورة محملة في النافذة المنبثقة

#### 4. الصورة لا تحفظ بعد القص
**الحل:**
- تحقق من إعدادات الخادم
- تأكد من صلاحيات الكتابة في مجلد الصور
- تحقق من حجم الصورة النهائي

### فحص الأخطاء:

#### 1. فتح وحدة التحكم:
```javascript
// اضغط F12 في المتصفح
// انتقل إلى تبويب Console
// ابحث عن أخطاء JavaScript
```

#### 2. فحص تحميل المكتبات:
```javascript
// في وحدة التحكم، اكتب:
console.log('Bootstrap:', typeof bootstrap);
console.log('Cropper:', typeof Cropper);
```

#### 3. فحص تهيئة Cropper:
```javascript
// في وحدة التحكم، اكتب:
console.log('Cropper instance:', cropper);
```

## ملف الاختبار:

تم إنشاء ملف `test-cropper.html` لاختبار وظيفة قص الصور بشكل منفصل.

### كيفية استخدام ملف الاختبار:
1. افتح `test-cropper.html` في المتصفح
2. ارفع صورة
3. اضغط "قص الصورة"
4. اختبر وظيفة القص
5. احفظ الصورة المقصوصة

## التحديثات المستقبلية:

### الميزات المقترحة:
1. **قص متعدد**: قص عدة صور في نفس الوقت
2. **قوالب جاهزة**: نسب عرض مختلفة للصور
3. **تحسين الجودة**: خيارات جودة مختلفة
4. **التحرير المتقدم**: تصفية وتأثيرات إضافية

### التحسينات التقنية:
1. **WebP دعم**: تحسين دعم صيغة WebP
2. **ضغط الصور**: ضغط تلقائي للصور الكبيرة
3. **التخزين المؤقت**: تحسين أداء تحميل الصور
4. **الأمان**: تحسين التحقق من صحة الملفات

## الدعم:

إذا واجهت أي مشاكل:
1. تحقق من هذا الدليل أولاً
2. استخدم ملف الاختبار `test-cropper.html`
3. تحقق من وحدة التحكم للأخطاء
4. تأكد من تحديث المتصفح

## ملاحظات تقنية:

### المتطلبات:
- متصفح حديث يدعم ES6+
- JavaScript مفعل
- اتصال بالإنترنت (لتحميل المكتبات)

### التوافق:
- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

### الأداء:
- الصور الكبيرة قد تستغرق وقتاً أطول للتحميل
- يوصى بضغط الصور قبل الرفع
- استخدم صيغة WebP للحصول على أفضل أداء 